{"version":3,"sources":["scripts/preprocess.js","scripts/tooltip.js","scripts/viz4.js","scripts/alluvial.js","scripts/viz1.js","../node_modules/scrollama/build/scrollama.js","scripts/scrolly/network.js","scripts/scrolly.js","index.js"],"names":["data","sankeyData","alluvialData","filteredAlluvialData","companiesFlightArray","topCompaniesCount","companiesAircrafts","topCompaniesSet","Set","setData","newData","setCompaniesFlightCount","setAlluvialData","forEach","d","push","airline","duration","departureTime","flightRange","count","parseInt","filterAlluvialData","index","findIndex","company","found","find","f","otherCount","setSankeyData","airlineDurationCounts","key","concat","durationDepartureCounts","departureFlightCounts","Object","keys","_key$split2","_slicedToArray","split","source","target","level","_key$split4","_key$split6","getData","_toConsumableArray","getSankeyData","getAlluvialData","getFilteredAlluvialData","getCompaniesFlightArray","getTopCompaniesCount","setTopCompaniesCount","getCompaniesAircraftsMap","groupByMainCompanies","agg","Map","x","has","airportIn","airportOut","keyBis","get","set","parseFloat","number","flyArray","value","Promise","resolve","reject","resizeTopCompagnies","bottomBucket","selection","splice","add","topCompanies","delete","numOthers","sortedCompanies","entries","sort","a","b","setCompaniesAircraftsMap","aircraftsData","aircrafts","opName","type","Tooltip","attachElement","arguments","length","undefined","_classCallCheck","_defineProperty","element","d3","select","append","attr","style","_createClass","m","html","pageY","text","color","svg","transition","selectAll","remove","name","window","innerWidth","category","fraction","total","exports","default","biggestCompaniesAircrafts","otherCompaniesAircrafts","preprocess","_interopRequireWildcard","require","_tooltip","_interopRequireDefault","obj","__esModule","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","newObj","hasPropertyDescriptor","defineProperty","getOwnPropertyDescriptor","prototype","hasOwnProperty","call","desc","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Array","from","isArray","_arrayLikeToArray","_createForOfIteratorHelper","o","allowArrayLike","it","i","F","s","n","done","e","_e","normalCompletion","err","didErr","step","next","_e2","return","minLen","toString","slice","constructor","test","len","arr2","colorScale","FACTOR","COLUMN_NUMBER","SQUARE_SIZE","INTERGAP_SPACE","tooltip","initWaffle","onscroll","scrollY","csv","then","files","drawWaffles","separateBigFromOthers","drawOtherCompaniesWaffle","drawTopCompaniesWaffles","addLegend","modifyData","viz","biggestCompaniesFlights","_step","_iterator","typeCount","createScale","domain","map","scaleOrdinal","range","schemeCategory10","calculateWaffleDimensions","reduce","acc","rows","Math","ceil","otherCompaniesWaffleHeight","width","height","cols","squareSize","offset","waffleify","div","drawWaffle","companyMap","othersCount","totalPark","prev","item","waffles","round","enter","on","showTooltipAircrafts","moveTooltip","hideTooltip","legendItems","graph","nodes","links","loadData","createAlluvialViz","initAlluvial","extractTimes","sankey","nodeSort","nodeWidth","nodePadding","size","console","log","sourceIndex","node","targetIndex","sourceNode","targetNode","x0","y0","filter","getBoundingClientRect","y1","x1","event","showAlluvialNode","showTooltipNode","layer","resetAlluvial","join","sankeyLinkHorizontal","max","showAlluvialLink","showTooltipLink","bbox","getBBox","y","highlightLinks","alluvialToHighlight","sankeyToHighlight","link","sd","sum","ad","linkPath","colorPercentage","sourceName","targetName","nameArray","includes","nodeName","alluvial","waffle","BUCKET_HEIGHT","BUCKET_WIDTH","displayBucketGraph","heightScale","createHeightScale","topBucket","setUpSlider","displayTopBucket","displayBottomBucket","setAnimation","slider","document","getElementById","sliderValue","innerHTML","oninput","c","showTooltipTop","toolTipDisplay","flightTotal","showTooltipBottom","maxHeight","scaleLinear","min","hublot","lid","handle","open","onclick","classList","_typeof","instance","Constructor","_defineProperties","props","descriptor","enumerable","configurable","writable","_toPropertyKey","protoProps","staticProps","arg","_toPrimitive","String","input","hint","prim","toPrimitive","res","Number","Network","ratio","tooltipLegend","airportCode","levelGeo","null","ccolor","currentGeo","limits","minMaxXGlobal","minMaxYGlobal","isFlightShow","createLegend","val","self","createLegendNetwork","infoButtion_siCliked","showLegendNetwork","hiddenLegendNetwork","localairports","_this","addAirportLegendNetwork","_i","_arr","cont","nb","minMaxX","extent","lat","minMaxY","lon","airport","ease","easePolyInOut","circles","scaleSize","freq","showTooltipAirport","country","city","continent","easeCubicOut","delay","updateCurrentState","bind","localflights","_this2","addFlightLegendNetwork","easeCubicInOut","raise","_this3","firstTransition","lvl","delAirportLegendNetwork","delFlightLegendNetwork","_scrollama","_network","scrolly","figure","article","figureHeight","innerHeight","scroller","scrollama","figWidth","network","handleStepEnter","response","direction","displayAirports","displayFlights","removeAirports","removeFlights","handleResize","stepH","floor","figureMarginTop","resize","handleStepExit","initNetwork","setup","debug","onStepExit","onStepEnter","buckets","onbeforeunload","scrollTo","onload","all"],"mappings":"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","file":"src.190caf3d.js","sourceRoot":"..\\src","sourcesContent":["let data = [];\nlet sankeyData = [];\nlet alluvialData = [];\nlet filteredAlluvialData = [];\nlet companiesFlightArray = [];\nlet topCompaniesCount = 0;\nlet companiesAircrafts = [];\n\nlet topCompaniesSet = new Set();\n\nexport function setData(newData) {\n  data = newData\n  companiesFlightArray = setCompaniesFlightCount(data);\n}\n\nexport function setAlluvialData(data) {\n  alluvialData = [];\n  data.forEach(d => {\n    alluvialData.push({airline: d.airline, duration: d.duration, departureTime: d.departureTime, flightRange: d.flightRange, count: parseInt(d.count)});\n  });\n}\n\nexport function filterAlluvialData() {\n  filteredAlluvialData = [];\n\n  alluvialData.forEach(d => {\n    let index = companiesFlightArray.findIndex(company => company[0] === d.airline);\n    if (index >= 0 && index < topCompaniesCount) {\n      filteredAlluvialData.push(d);\n    } else {\n      let found = filteredAlluvialData.find(f => f.duration === d.duration && f.departureTime === d.departureTime && f.flightRange === d.flightRange && f.airline === 'OTHERS');\n      if (found) {\n        found.count += d.count;\n      } else {\n        filteredAlluvialData.push({airline: 'OTHERS', duration: d.duration, departureTime: d.departureTime, flightRange: d.flightRange, count: d.count});\n      }\n    }\n  });\n\n  let index = companiesFlightArray.findIndex(company => company === 'OTHERS');\n  if (index >= 0 && index < topCompaniesCount) {\n    let found = filteredAlluvialData.find(f => f.airline === 'OTHERS');\n    if (found) {\n      found.count += otherCount;\n    } else {\n      filteredAlluvialData.push({airline: 'OTHERS', duration: '', departureTime: '', flightRange: '', count: otherCount});\n    }\n  }\n\n  setSankeyData();\n}\n\n\nexport function setSankeyData() {\n  // 'filteredAlluvialData' is the array of objects containing airline, duration, departureTime, and flightRange\n\n  sankeyData = [];\n  // count objects with same airline and duration\n  const airlineDurationCounts = {};\n  filteredAlluvialData.forEach(d => {\n    const key = `${d.airline}_${d.duration}`;\n    if (!airlineDurationCounts[key]) {\n      airlineDurationCounts[key] = 0;\n    }\n    airlineDurationCounts[key] += d.count;\n  });\n\n  // count objects with same duration and departureTime\n  const durationDepartureCounts = {};\n  filteredAlluvialData.forEach(d => {\n    const key = `${d.duration}_${d.departureTime}`;\n    if (!durationDepartureCounts[key]) {\n      durationDepartureCounts[key] = 0;\n    }\n    durationDepartureCounts[key] += d.count;\n  });\n\n  // count objects with same departureTime and flightRange\n  const departureFlightCounts = {};\n  filteredAlluvialData.forEach(d => {\n    const key = `${d.departureTime}_${d.flightRange}`;\n    if (!departureFlightCounts[key]) {\n      departureFlightCounts[key] = 0;\n    }\n    departureFlightCounts[key] += d.count;\n  });\n\n  Object.keys(airlineDurationCounts).forEach(key => {\n    const [airline, duration] = key.split('_');\n    const source = airline;\n    const target = duration;\n    const count = airlineDurationCounts[key];\n    sankeyData.push({source, target, count, level: 0});\n  });\n  Object.keys(durationDepartureCounts).forEach(key => {\n    const [duration, departureTime] = key.split('_');\n    const source = duration;\n    const target = departureTime;\n    const count = durationDepartureCounts[key];\n    sankeyData.push({source, target, count, level: 1});\n  });\n  Object.keys(departureFlightCounts).forEach(key => {\n    const [departureTime, flightRange] = key.split('_');\n    const source = departureTime;\n    const target = flightRange;\n    const count = departureFlightCounts[key];\n    sankeyData.push({source, target, count, level: 2});\n  });\n\n  return sankeyData;\n}\n\nexport function getData() {\n  return [...data];\n}\n\nexport function getSankeyData() {\n  return [...sankeyData];\n}\n\nexport function getAlluvialData() {\n  return [...alluvialData];\n}\n\nexport function getFilteredAlluvialData() {\n  return [...filteredAlluvialData];\n}\n\nexport function getCompaniesFlightArray() {\n  return [...companiesFlightArray];\n}\n\nexport function getTopCompaniesCount(){\n  return topCompaniesCount;\n}\n\nexport function setTopCompaniesCount(count){\n  topCompaniesCount = count;\n}\n\nexport function getCompaniesAircraftsMap() {\n  return companiesAircrafts;\n}\n\n\nexport function groupByMainCompanies(data) {\n  let agg = new Map()\n  data.forEach(function (x) {\n    if (topCompaniesSet.has(x.company)) { } else {\n      x.company = \"OTHERS\"\n    }\n    let key = [x.company, x.airportIn, x.airportOut]\n    let keyBis = [x.company, x.airportOut, x.airportIn]\n\n    if (agg.get(key)) {\n      agg.set(key, agg.get(key) + parseFloat(x.number))\n    } else if (agg.get(keyBis)) {  \n      agg.set(keyBis, agg.get(keyBis) + parseFloat(x.number))\n    } else {\n      agg.set(key, parseFloat(x.number))\n    }\n  })\n  let flyArray = []\n  agg.forEach(function (value, key) {\n    flyArray.push({ company: key[0], airportIn: key[1], airportOut: key[2], number: value})\n  })\n  return new Promise((resolve, reject) => resolve(flyArray))\n}\n\nexport function resizeTopCompagnies(bottomBucket) {\n  let selection = bottomBucket.splice(0,   topCompaniesCount);\n  selection.forEach(d => topCompaniesSet.add(d[0]))\n  return selection;\n}\n\nfunction setCompaniesFlightCount(data) {\n  const topCompanies = new Map()\n  data.forEach((d) => {\n    if (!topCompanies.get(d.company)) {\n      topCompanies.set(d.company, parseFloat(d.number))\n    }\n    else {\n      topCompanies.set(d.company, topCompanies.get(d.company) + parseFloat(d.number))\n    }\n  })\n  topCompanies.delete('NULL')\n  topCompanies.delete('')\n  let numOthers = topCompanies.get(\"OTHERS\")\n  topCompanies.delete(\"OTHERS\")\n\n  let sortedCompanies = [...topCompanies.entries()].sort((a, b) => b[1] - a[1])\n\n  sortedCompanies.push([\"OTHERS\", numOthers])\n  return sortedCompanies\n}\n\nexport function setCompaniesAircraftsMap(aircraftsData) {\n  const aircrafts = new Map();\n\n  aircraftsData.forEach((d) => {\n      let opName = d.company;\n\n      if (opName == \"\" || opName == \"NULL\") return;\n\n      if (!aircrafts.get(opName)) {\n          if (opName)\n          aircrafts.set(opName, new Map());\n      }\n\n      let type = d.type == '' || d.type == 'NULL' ? 'Inconnu' : d.type;\n\n      if (!aircrafts.get(opName).get(type)) {\n          aircrafts.get(opName).set(type, 1);\n      }\n\n      else {\n          aircrafts.get(opName).set(type, aircrafts.get(opName).get(type) + 1);\n      }\n  })\n  companiesAircrafts = aircrafts;\n\n  return aircrafts;\n  \n}","\nexport default class Tooltip {\n    element;\n\n    constructor(attachElement = \"body\") {\n        this.element = d3.select(attachElement)\n            .append(\"div\")\n            //.style(\"opacity\", 0)\n            .attr(\"class\", \"tooltip\")\n            .style(\"background-color\", \"black\")\n            .style(\"border-radius\", \"5px\")\n            .style(\"padding\", \"10px\")\n            .style(\"color\", \"white\")\n            .style('position', 'absolute')\n            .style(\"display\", \"none\")\n    }\n\n    showTooltipTop(m, d) {\n        this.element\n            .style(\"opacity\", 1)\n            .html(d[0] + \": \" + d[1] + \" vols\")\n            .style(\"left\", (m.x + 30) + \"px\")\n            .style(\"top\", (m.pageY + 30) + \"px\")\n            .style('width', null)\n            .style(\"display\", \"block\")\n    }\n\n    addAirportLegendNetwork(level, text, color) {\n        const svg = this.element\n            .select(\"#legAirportsBlock\")\n            .append('svg')\n            .attr(\"class\", \"legAirport_\" + level)\n            .attr(\"height\", \"40px\")\n\n        svg.append(\"circle\")\n            .transition()\n            .duration(300)\n            .attr(\"r\", 9)\n            .attr(\"cx\", 10)\n            .attr(\"cy\", 10)\n            .attr(\"fill\", color)\n            .attr('stroke', 'black')\n            .attr('stroke-width', '1')\n\n        svg.append(\"text\")\n            .transition()\n            .duration(300)\n            .text(\"Aéroport \" + text)\n            .attr(\"x\", 30)\n            .attr(\"y\", 15)\n    }\n\n    delFlightLegendNetwork() {\n        d3.selectAll(\".legFlight\").transition()\n            .duration(300).remove()\n    }\n\n    addFlightLegendNetwork(text, color) {\n        const svg = this.element.select(\"#legFlightsBlock\").append('svg')\n            .attr(\"class\", \"legFlight\")\n            .attr(\"height\", \"40px\")\n\n        svg.append(\"rect\")\n            .transition()\n            .duration(300)\n            .attr(\"width\", 30)\n            .attr(\"height\", 10)\n            .attr(\"x\", -5)\n            .attr(\"y\", 5)\n            .attr(\"fill\", color)\n\n        svg.append(\"text\")\n            .transition()\n            .duration(300)\n            .text(text)\n            .attr(\"x\", 30)\n            .attr(\"y\", 15)\n    }\n\n    delAirportLegendNetwork(level) {\n        d3.selectAll(\".legAirport_\" + level)\n            .transition()\n            .duration(300)\n            .remove()\n    }\n\n    createLegendNetwork() {\n        this.element\n            .style(\"background\", \"rgba(255,255,255,0.5)\")\n            .style(\"left\", 3 + \"px\")\n            .style(\"top\", 35 + \"px\")\n            .style('width', '300px')\n            .style('height', '500px')\n            .attr('id', 'infoNetwork')\n            .style(\"opacity\", 0)\n\n        this.element\n            .append(\"div\")\n            .attr(\"id\", \"legFlightsBlock\")\n\n        this.element\n            .append(\"div\")\n            .attr(\"id\", \"legAirportsBlock\")\n    }\n\n    showLegendNetwork() {\n        this.element\n            .transition()\n            .duration(300)\n            .style(\"opacity\", 1)\n            .style(\"display\", \"block\")\n    }\n\n    hiddenLegendNetwork() {\n        this.element.style(\"display\", \"none\")\n            .style(\"opacity\", 0)\n    }\n\n    showTooltipBottom(m, d) {\n        this.element\n            .style(\"opacity\", 1)\n            .html(\"Prochaines 5 plus grandes compagnies: <br>\" + d)\n            .style(\"left\", (m.x + 30) + \"px\")\n            .style(\"top\", (m.pageY + 30) + \"px\")\n            .style('width', '300px')\n            .style(\"display\", \"block\")\n    }\n\n\n    showTooltipLink(m, source, target, value, level) {\n        var text = \"\";\n\n        switch(level) {\n            case 0: \n                text = `${value} vols ${target}-courriers<br>effectués par ${source}`\n                break;\n            case 1:\n                text = `${value} vols ${source}-courriers<br>effectués entre ${target}`\n                break;\n            case 2: \n                text = `${value} vols effectués<br>entre ${source} de desserte ${target}`\n                break;\n        }\n\n        this.element\n            .style(\"opacity\", 0.7)\n            .html(text)\n            .style(\"left\", (m.x + 30) + \"px\")\n            .style(\"top\", (m.pageY + 30) + \"px\")\n            .style(\"display\", \"block\")\n    }\n\n\n\n    showTooltipNode(m, name, value, level) {\n        var text = \"\";\n        switch(level) {\n            case 0: \n                text = `${value} vols effectués par ${name}`\n                break;\n            case 1:\n                text = `${value} vols ${name}-courriers`\n                break;\n            case 2: \n                text = `${value} vols effectués entre ${name}`\n                break;\n            default:\n                text = `${value} vols de desserte ${name}`\n                break;\n        }\n\n        this.element\n            .style(\"opacity\", 0.7)\n            .html(text)\n            .style(\"left\", (m.x + 30) + \"px\")\n            .style(\"top\", (m.pageY + 30) + \"px\")\n            .style(\"display\", \"block\")\n    }\n\n    showTooltipAirport(m, d) {\n        this.element\n            .style(\"opacity\", 0.7)\n            .html(d[0] + \"<br>\" + d[2] + \" - \" + d[1] + \"<br>\"+ d[3] + \" vols\")\n            .style(\"left\", ((m.x > window.innerWidth * 0.5) ? (m.x - 90) : (m.x + 30)) + \"px\")\n            .style(\"top\", (m.pageY + 30) + \"px\")\n            .style(\"display\", \"block\")\n    }\n\n    showTooltipAircrafts(m, d) {\n\n        this.element\n            .style(\"opacity\", 1)\n            .html('Aéronef de type: ' + d.category + '<br>' + 'Quantité: ' + d.fraction + ' / ' + d.total)\n            .style(\"left\", (m.x + 30) + \"px\")\n            .style(\"top\", (m.pageY + 30) + \"px\")\n            .style(\"display\", \"block\")\n    }\n\n    moveTooltip(m) {\n        this.element\n            .style(\"left\", (m.x + 30) + \"px\")\n            .style(\"top\", (m.pageY + 30) + \"px\")\n    }\n\n    hideTooltip() {\n        this.element.style(\"display\", \"none\")\n    }\n}","import * as preprocess from \"./preprocess.js\"\nimport Tooltip from \"./tooltip.js\"\n\nlet biggestCompaniesAircrafts;\nlet otherCompaniesAircrafts;\nlet colorScale = {}\nconst FACTOR = 5;\nconst COLUMN_NUMBER = 25;\nconst SQUARE_SIZE = 20;\nconst INTERGAP_SPACE = 5;\n\nlet tooltip = new Tooltip();\n\nexport function initWaffle() {\n\twindow.onscroll = function () {\n\t\tvar scrollPos = window.scrollY;\n\n\t\tif (scrollPos >= 4000) {\n\t\t\twindow.onscroll = null;\n\t\t\td3.csv('./aircrafts.csv').then(function (files) {\n\t\t\t\tpreprocess.setCompaniesAircraftsMap(files);\n\t\t\t\tdrawWaffles();\n\t\t\t})\n\t\t}\n\t}\n}\n\nexport function drawWaffles() {\n\tseparateBigFromOthers();\n\n\tdrawOtherCompaniesWaffle();\n\tdrawTopCompaniesWaffles();\n\taddLegend();\n\n}\n\nexport function modifyData() {\n\tconst viz = d3.select('#viz4')\n\tviz.select('#topWaffles').remove();\n\tviz.select('#otherWaffle').remove();\n\tviz.select('.legend').remove();\n\n\tseparateBigFromOthers();\n\n\tdrawOtherCompaniesWaffle();\n\tdrawTopCompaniesWaffles();\n\taddLegend();\n}\n\nfunction separateBigFromOthers() {\n\tconst biggestCompaniesFlights = preprocess.getCompaniesFlightArray();\n\tconst companiesAircrafts = preprocess.getCompaniesAircraftsMap();\n\tbiggestCompaniesAircrafts = new Map();\n\totherCompaniesAircrafts = new Map();\n\tbiggestCompaniesFlights.forEach((d, index) => {\n\t\tif (index < preprocess.getTopCompaniesCount())\n\t\t\tbiggestCompaniesAircrafts.set(d[0], companiesAircrafts.get(d[0]))\n\t\telse {\n\t\t\tfor (const typeCount of companiesAircrafts.get(d[0])) {\n\t\t\t\tconst name = typeCount[0];\n\n\t\t\t\tif (!otherCompaniesAircrafts.get(name))\n\t\t\t\t\totherCompaniesAircrafts.set(name, 0);\n\t\t\t\totherCompaniesAircrafts.set(\n\t\t\t\t\tname,\n\t\t\t\t\totherCompaniesAircrafts.get(name) + typeCount[1]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t})\n}\n\nfunction createScale(data) {\n\tconst domain = data.map((d) => {\n\t\treturn d.category;\n\t});\n\tcolorScale = d3.scaleOrdinal()\n\t\t.domain(domain)\n\t\t.range(d3.schemeCategory10);\n}\n\nfunction calculateWaffleDimensions(data, FACTOR) {\n\tconst total = data.reduce((acc, d) => acc + d.value, 0);\n\t// let cols = Math.floor(Math.sqrt(((total / FACTOR) * width) / height));\n\t//if(cols === 0) cols = 1\n\tconst rows = Math.ceil(total / FACTOR / 25);\n\totherCompaniesWaffleHeight = rows * SQUARE_SIZE + rows * INTERGAP_SPACE;\n\n\treturn {\n\t\twidth: COLUMN_NUMBER * SQUARE_SIZE + COLUMN_NUMBER * INTERGAP_SPACE,\n\t\theight: otherCompaniesWaffleHeight,\n\t\trows,\n\t\tcols: COLUMN_NUMBER,\n\t\tsquareSize: SQUARE_SIZE,\n\t\toffset: INTERGAP_SPACE,\n\t};\n}\n\nfunction drawOtherCompaniesWaffle() {\n\tconst data = waffleify(otherCompaniesAircrafts);\n\tconst div = d3.select(\"#viz4\")\n\t\t.append('div')\n\t\t.attr('id', 'otherWaffle')\n\t\t.append('div')\n\t\t.attr('class', 'waffle')\n\n\tcreateScale(data);\n\tdrawWaffle(data, div);\n\td3.select(\"#otherWaffle\")\n\t\t.append('p')\n\t\t.attr('class', 'waffleLabel')\n\t\t.html(\"AUTRES COMPAGNIES\");\n\n}\n\nfunction drawTopCompaniesWaffles() {\n\td3.select(\"#viz4\")\n\t\t.append(\"div\")\n\t\t.attr('id', 'topWaffles')\n\n\tlet index = 0;\n\tbiggestCompaniesAircrafts.forEach((companyMap, name) => {\n\t\tconst div = d3.select(\"#topWaffles\")\n\t\t\t.append(\"div\")\n\t\t\t.attr(\"class\", 'waffle')\n\n\t\tdrawWaffle(waffleify(companyMap), div, index);\n\t\td3.select(\"#topWaffles\")\n\t\t\t.append('p')\n\t\t\t.attr('class', 'waffleLabel')\n\t\t\t.html(name);\n\t\tindex++;\n\t});\n\n}\n\nfunction waffleify(data) {\n\tconst newData = [];\n\t[...data.entries()].forEach((d) => {\n\t\tnewData.push({ category: d[0], value: d[1] });\n\t});\n\tnewData.sort((a, b) => b.value - a.value)\n\tlet othersCount = 0;\n\tif (newData.length > 8) {\n\t\tfor (let i = 8; i < newData.length; i++) {\n\t\t\tothersCount += newData[i].value;\n\t\t}\n\t}\n\tnewData.splice(8, newData.length - 8);\n\tnewData.push({ category: \"Autres\", value: othersCount })\n\n\tlet totalPark = newData.reduce((prev, item) => prev + item.value, 0);\n\n\tconst waffles = [];\n\tnewData.forEach((d) => {\n\t\tfor (let i = 0; i < Math.round(d.value / FACTOR); i++) {\n\t\t\twaffles.push({ category: d.category, fraction: d.value, total: totalPark });\n\t\t}\n\t});\n\n\treturn waffles;\n}\n\nfunction drawWaffle(waffles, div) {\n\tdiv.selectAll('.block')\n\t\t.data(waffles)\n\t\t.enter()\n\t\t.append('div')\n\t\t.attr('background-image', 'url(\\'img/plane-icon.png\\')')\n\t\t.attr('class', 'block')\n\t\t.style('background-color', d => colorScale(d.category))\n\t\t.on(\"mouseover\", function (m, d) {\n\t\t\ttooltip.showTooltipAircrafts(m, d);\n\t\t})\n\n\tdiv.on(\"mousemove\", function (m) { \n\t\t\treturn tooltip.moveTooltip(m) \n\t\t})\n\t\t.on(\"mouseleave\", function () {\n\t\t\treturn tooltip.hideTooltip();\n\t\t});\n\n}\n\n\nfunction addLegend() {\n\td3.select('#viz4').append('br')\n\tconst legendContainer = d3.select('#viz4')\n\t\t.append('svg')\n\t\t.attr('class', 'legend')\n\t\t.attr('height', '50')\n\t\t.attr('width', colorScale.domain().length * 50 + 50)\n\t\t.append('g')\n\t\t.attr('class', 'legend-container')\n\t\t.attr('transform', 'translate(10, 10)')\n\n\tconst legendItems = legendContainer.selectAll('.legend-item')\n\t\t.data(colorScale.domain())\n\t\t.enter()\n\t\t.append('g')\n\t\t.attr('class', 'legend-item')\n\t\t.attr('transform', (d, i) => `translate(${i * 50}, 0)`);\n\n\tlegendItems.append('rect')\n\t\t.attr('width', 15)\n\t\t.attr('height', 15)\n\t\t.attr('margin-bottom', '3px')\n\t\t.style('fill', colorScale);\n\n\tlegendItems.append('text')\n\t\t.attr('x', 20)\n\t\t.attr('y', 15)\n\t\t.style('font-size', 'medium')\n\t\t.text(d => d);\n}\n","import * as preprocess from \"./preprocess.js\"\r\nimport Tooltip from \"./tooltip.js\";\r\n\r\nlet sankeyData = [];\r\nlet alluvialData = [];\r\n\r\nlet graph = {\r\n  nodes: [],\r\n  links: [],\r\n};\r\n\r\nconst width = 1500;\r\nconst height = 1000;\r\n\r\nconst tooltip = new Tooltip();\r\n\r\nexport function loadData() {\r\n  d3.select(\"#viz3\").on(\"mouseover\", null)\r\n  d3.csv('./alluvial_data.csv')\r\n    .then(files => {\r\n      preprocess.setAlluvialData(files[0]);\r\n      createAlluvialViz();\r\n    })\r\n}\r\n\r\nexport function initAlluvial() {\r\n  d3.select(\"#viz3\").on(\"mouseover\", loadData)\r\n}\r\n\r\n\r\n/* Ne correspond à rien \r\nA MODIFIER\r\n*/\r\nfunction extractTimes(name) {\r\n  switch(name) {\r\n    case \"matin\":\r\n      return \"4h-10h\"\r\n    case \"après-midi\":\r\n      return \"10h-16h\"\r\n    case \"soire\":\r\n      return \"16h-22h\"\r\n    case \"nuit\":\r\n      return \"22h-4h\"\r\n    default:\r\n      return name\r\n  }\r\n}\r\n\r\n\r\nexport function createAlluvialViz() {\r\n\r\n  sankeyData = preprocess.getSankeyData();\r\n\r\n  graph.nodes = [];\r\n  graph.links = [];\r\n\r\n  d3.select(\"#alluvialChart\").remove();\r\n\r\n  const svg = d3.select(\"#viz3\")\r\n    .append(\"svg\")\r\n    .attr(\"id\", \"alluvialChart\")\r\n    .attr(\"width\", \"70%\")\r\n\r\n  const sankey = d3.sankey()\r\n    .nodeSort(null)\r\n    .nodeWidth(15)\r\n    .nodePadding(10)\r\n    .size([width, height]);\r\n\r\n  console.log(sankeyData)\r\n\r\n  sankeyData.forEach(d => {\r\n    const sourceIndex = graph.nodes.findIndex(\r\n      node => node.name === d.source\r\n    );\r\n    const targetIndex = graph.nodes.findIndex(\r\n      node => node.name === d.target\r\n    );\r\n\r\n    const sourceNode = { name: d.source };\r\n    const targetNode = { name: d.target };\r\n\r\n    if (sourceIndex === -1) graph.nodes.push(sourceNode);\r\n    if (targetIndex === -1) graph.nodes.push(targetNode);\r\n\r\n    graph.links.push({\r\n      source: sourceIndex === -1 ? sourceNode : graph.nodes[sourceIndex],\r\n      target: targetIndex === -1 ? targetNode : graph.nodes[targetIndex],\r\n      value: d.count,\r\n      level: d.level\r\n    });\r\n  });\r\n\r\n  console.log(graph.nodes)\r\n  sankey(graph);\r\n\r\n  const node = svg.append(\"g\")\r\n    .selectAll(\".node\")\r\n    .data(graph.nodes)\r\n    .enter()\r\n    .append(\"g\")\r\n    .attr(\"class\", \"node\")\r\n    .attr(\"transform\", d => `translate(${d.x0},${d.y0})`);\r\n\r\n  const lastNode = node.filter((d, i) => i === graph.nodes.length - 1);\r\n  const lastNodeHeight = lastNode.node().getBoundingClientRect().height;\r\n\r\n  node.append(\"rect\")\r\n    .attr(\"height\", d => d.y1 - d.y0)\r\n    .attr(\"width\", d => d.x1 - d.x0)\r\n    .on(\"mouseover\", (event, d) => {\r\n      showAlluvialNode(d.name);\r\n      return tooltip.showTooltipNode(event, extractTimes(d.name), d.value, d.layer)\r\n    })\r\n    .on(\"mousemove\", function(event) {\r\n      return tooltip.moveTooltip(event)\r\n    })\r\n    .on(\"mouseout\", function() {\r\n      tooltip.hideTooltip()\r\n      resetAlluvial()\r\n    })\r\n    .style(\"fill\", \"#a52a2a\");\r\n\r\n  node\r\n    .append(\"text\")\r\n    .attr('class', 'alluvial-labels')\r\n    .attr(\"x\", d => d.x0 < width / 2 ? 25 : -10)\r\n    .attr(\"y\", d => (d.y1 - d.y0) / 2)\r\n    .attr(\"dy\", \"0.35em\")\r\n    .style(\"padding-top\", 10)\r\n    .attr(\"text-anchor\", d => d.x0 < width / 2 ? \"start\" : \"end\")\r\n    .text(d => d.name)\r\n    .style(\"font-size\", \"18px\");\r\n\r\n  const link = svg\r\n    .append(\"g\")\r\n    .attr(\"fill\", \"none\")\r\n    .attr(\"stroke-opacity\", 0.5)\r\n    .selectAll(\"g\")\r\n    .data(graph.links)\r\n    .join(\"g\")\r\n    .attr(\"stroke\", \"gray\");\r\n\r\n  link\r\n    .attr(\"id\", d => 'link-' + d.index)\r\n    .append(\"path\")\r\n    .attr(\"d\", d3.sankeyLinkHorizontal())\r\n    .attr(\"stroke-width\", d => Math.max(1, d.width))\r\n    .on(\"mouseover\", (event, d) => {\r\n      showAlluvialLink(d.source.name, d.target.name);\r\n      return tooltip.showTooltipLink(event, extractTimes(d.source.name), extractTimes(d.target.name), d.value, d.level)\r\n    })\r\n    .on(\"mouseout\", resetAlluvial)\r\n\r\n  // Get the bounding box of all the g elements\r\n  const bbox = svg.select(\"g\").node().getBBox();\r\n\r\n  // Set the viewBox attribute on the svg element\r\n  svg.attr(\"viewBox\", `${bbox.x} ${bbox.y} ${bbox.width} ${bbox.height}`);\r\n}\r\n\r\n\r\nfunction highlightLinks(alluvialToHighlight, sankeyToHighlight) {\r\n\r\n\r\n  graph.links.forEach(link => {\r\n    const linkPath = d3.select(\"#link-\" + link.index + \" path\");\r\n    linkPath.attr(\"stroke-width\", 0);\r\n  });\r\n\r\n  sankeyToHighlight.forEach(sd => {\r\n    let sum = 0;\r\n    alluvialToHighlight.forEach(ad => {\r\n      if ((ad['airline'] == sd['source'] && ad['duration'] == sd['target']) ||\r\n        (ad['duration'] == sd['source'] && ad['departureTime'] == sd['target']) ||\r\n        (ad['departureTime'] == sd['source'] && ad['flightRange'] == sd['target'])) {\r\n        sum += ad['count'];\r\n      }\r\n    });\r\n    sd['count'] = sum;\r\n\r\n    graph.links.forEach(link => {\r\n      const linkPath =  d3.select(\"#link-\" + link.index + \" path\");\r\n      if (link['source'].name == sd['source'] && link['target'].name == sd['target']) {\r\n        const colorPercentage = sd['count'] / link['value'];\r\n        linkPath.attr(\"stroke-opacity\", 0.5)\r\n          .attr(\"stroke\", \"red\")\r\n          .attr(\"stroke-width\", d => Math.max(1, d.width * colorPercentage))\r\n          .on(\"mousemove\", function(event) {\r\n            return tooltip.moveTooltip(event)\r\n          })\r\n          .on(\"mouseout\", function() {\r\n            resetAlluvial();\r\n            return tooltip.hideTooltip();\r\n          })\r\n          \r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction showAlluvialLink(sourceName, targetName) {\r\n  alluvialData = preprocess.getFilteredAlluvialData();\r\n  let alluvialToHighlight = [];\r\n  let sankeyToHighlight = [];\r\n\r\n  // Filter the alluvialData to include only the relevant connections\r\n  alluvialData.forEach(d => {\r\n    const nameArray = [d['airline'], d['duration'], d['departureTime'], d['flightRange']]\r\n    if ( nameArray.includes(sourceName) && nameArray.includes(targetName)) {\r\n      alluvialToHighlight.push(d);\r\n    }\r\n  });\r\n\r\n  // Filter the sankeyData to include only the relevant connections\r\n  alluvialToHighlight.forEach(ad => {\r\n    const nameArray = [ad['airline'], ad['duration'], ad['departureTime'], ad['flightRange']]\r\n    sankeyData.forEach(sd => {\r\n      if (nameArray.includes(sd['source']) && nameArray.includes(sd['target'])) {\r\n        if (!sankeyToHighlight.includes(sd)) {\r\n          sankeyToHighlight.push(sd);\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  highlightLinks(alluvialToHighlight, sankeyToHighlight);\r\n}\r\n\r\nfunction showAlluvialNode(nodeName) {\r\n  alluvialData = preprocess.getFilteredAlluvialData();\r\n  let alluvialToHighlight = [];\r\n  let sankeyToHighlight = [];\r\n\r\n  // Filter the alluvialData to include only the relevant connections\r\n  alluvialData.forEach(d => {\r\n    const nameArray = [d['airline'], d['duration'], d['departureTime'], d['flightRange']]\r\n    if (nameArray.includes(nodeName)) {\r\n      alluvialToHighlight.push(d);\r\n    }\r\n  });\r\n\r\n  // Filter the sankeyData to include only the relevant connections\r\n  alluvialToHighlight.forEach(ad => {\r\n    sankeyData.forEach(sd => {\r\n      if ((sd['source'] == ad['airline'] && sd['target'] == ad['duration']) || (sd['source'] == ad['duration'] && sd['target'] == ad['departureTime']) ||\r\n        (sd['source'] == ad['departureTime'] && sd['target'] == ad['flightRange'])) {\r\n        if (!sankeyToHighlight.includes(sd)) {\r\n          sankeyToHighlight.push(sd);\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  highlightLinks(alluvialToHighlight, sankeyToHighlight);\r\n}\r\n\r\nfunction resetAlluvial() {\r\n  graph.links.forEach(link => {\r\n    const linkPath =  d3.select(\"#link-\" + link.index + \" path\");\r\n    linkPath.attr(\"stroke\", \"gray\")\r\n      .attr(\"stroke-opacity\", 0.5)\r\n      .attr(\"stroke-width\", d => Math.max(1, d.width));\r\n  });\r\n}","import * as preprocess from './preprocess.js'\nimport * as alluvial from './alluvial.js'\nimport * as waffle from './viz4.js'\n\nimport Tooltip from './tooltip.js'\n\nconst BUCKET_HEIGHT = 300;\nconst BUCKET_WIDTH = 200;\n\nlet tooltip = new Tooltip();\n\n\nexport function displayBucketGraph() {\n  const companiesFlightArray = preprocess.getCompaniesFlightArray();\n  const heightScale = createHeightScale(companiesFlightArray);\n  const bottomBucket = [...companiesFlightArray];\n  const topBucket = preprocess.resizeTopCompagnies(bottomBucket);\n  setUpSlider()\n  displayTopBucket(topBucket, heightScale);\n  displayBottomBucket(bottomBucket, heightScale);\n  setAnimation()\n\n}\n\nexport function setUpSlider() {\n  const\tslider=document.getElementById(\"slider\")\n  const sliderValue=document.getElementById(\"slider-value\")\n  sliderValue.innerHTML=slider.value\n  preprocess.filterAlluvialData()\n\tslider.oninput=function() {\n      sliderValue.innerHTML=this.value\n      d3.select('#topSVG').selectAll('*').remove()\n      d3.select('#bottomSVG').selectAll('*').remove()\n      preprocess.setTopCompaniesCount(this.value)\n      displayBucketGraph()\n      preprocess.filterAlluvialData()\n      if(preprocess.getCompaniesAircraftsMap().length !== 0)\n        waffle.modifyData();\n    \n\t}\n  alluvial.createAlluvialViz();\n}\n\nfunction displayTopBucket(topBucket, heightScale) {\n  d3.select(\"#topSVG\")\n    .selectAll('.topCompany')\n    .data(topBucket)\n    .enter()\n    .append('g')\n    .attr('class', 'topCompany')\n    .append('rect')\n    .attr('class', 'bucket-tile')\n    .attr('y', function(c, index) {\n      let y = BUCKET_HEIGHT;\n      for(let i =0; i <= index; i++){\n        y -= heightScale(topBucket[i][1])\n      }\n      return y;\n    })\n    .attr('fill', 'rgb(75, 115, 47)')\n    .attr('height', function(c) { \n      return heightScale(c[1])})\n    .attr('width', BUCKET_WIDTH)\n    .attr('stroke', 'rgb(40, 63, 25)')\n    .attr('stroke-width', '2px')\n    .on(\"mouseover\", function(m, d) {\n      d3.select(this)\n        .attr('fill', 'rgb(124, 191, 78)')\n      return tooltip.showTooltipTop(m, d) }\n    )\n    .on(\"mousemove\", function(m) { return tooltip.moveTooltip(m) })\n    .on(\"mouseleave\", function() {\n      d3.select(this)\n        .attr('fill', 'rgb(75, 115, 47)')\n\n      return tooltip.hideTooltip()\n    } )\n  d3.selectAll('.topCompany')\n    .append('text')\n    .attr('y', function(c, index) {\n      let y = BUCKET_HEIGHT;\n      for(let i =0; i <= index; i++){\n        y -= heightScale(topBucket[i][1])\n      }\n      y +=heightScale(c[1])/2\n      return y;\n    })\n    .attr('x', function() {return BUCKET_WIDTH / 2})\n    .attr('font-size', '18px')\n    .attr('text-anchor', 'middle')\n    .attr('fill', 'white')\n    .style('pointer-events', 'none')\n    .style('user-select', 'none')\n    .text(function(c) {\n      const height = heightScale(c[1]);\n      if(height > 22){\n        return c[0];\n      }\n      else if (height > 7) {\n        return \"...\"\n      }\n      return \"\"\n    })\n}\n\nfunction displayBottomBucket(bottomBucket, heightScale) {\n  const height = heightScale(d3.sum(bottomBucket, function(c) {return c[1]}))\n  let toolTipDisplay = \"\"\n  let flightTotal = 0;\n  for(let i = 0; i < 5; i++){\n    toolTipDisplay += (i+1) + '.' + ' ' + bottomBucket[i][0] + ': ' + bottomBucket[i][1] + ' vols <br>'\n    flightTotal += bottomBucket[i][1];\n  }\n  toolTipDisplay += '<br><b>Nombre total de vols: ' + flightTotal + ' vols</b>'\n  d3.select(\"#bottomSVG\")\n    .append('g')\n    .attr('width', BUCKET_WIDTH)\n    .style('text-align', 'center')\n    .attr('class', 'bottomCompany')\n    .append('rect')\n    .attr('class', 'bucket-tile')\n    .attr('y', function(c, index) {\n      return BUCKET_HEIGHT - height;\n    })\n    .attr('fill', \"rgb(59, 56, 56)\")\n    .attr('height', function(c) { \n      return height})\n    .attr('width', BUCKET_WIDTH)\n    .attr('stroke-width', '2px')\n    .attr('stroke', 'rgb(44, 42, 42)')\n    .on(\"mouseover\", function(m) { \n      d3.select(this).style('fill', 'rgb(96, 91, 91)')\n      return tooltip.showTooltipBottom(m, toolTipDisplay) })\n    .on(\"mousemove\", function(m) { return tooltip.moveTooltip(m) })\n    .on(\"mouseleave\", function() {\n      d3.select(this).style('fill', 'rgb(59, 56, 56)')\n      return tooltip.hideTooltip()\n    } )\n  d3.select('.bottomCompany').append('text').attr('y', function() {\n      return BUCKET_HEIGHT - height/2;\n    })\n    .attr('x', function() {return BUCKET_WIDTH / 2})\n    .attr('font-size', '18px')\n    .attr('text-anchor', 'middle')\n    .attr('fill', 'white')\n    .style('pointer-events', 'none')\n    .style('user-select', 'none')\n    .text('Autres compagnies')\n}\n\nfunction createHeightScale (topCompanies) {\n  const maxHeight = d3.sum(topCompanies, c => c[1])\n  return d3.scaleLinear().domain([d3.min(topCompanies, function(d) {return d[1]}), maxHeight]).range([0, BUCKET_HEIGHT])\n}\n\nfunction setAnimation() {\n  const hublot = document.getElementById('right-hublot-cover');\n  const lid = document.getElementById('lid');\n  const handle = document.getElementById('handle');\n  let open = false;\n  document.getElementById('right-hublot').onclick = function () {\n    if(!open) {\n      hublot.classList.remove('closeLid');\n      lid.classList.remove('pullHandle');\n      handle.classList.remove('pullHandle');\n      hublot.classList.add('openLid');\n      lid.classList.add('liftHandle');\n      handle.classList.add('liftHandle');\n    }\n    else {\n      hublot.classList.remove('openLid');\n      lid.classList.remove('liftHandle');\n      handle.classList.remove('liftHandle');\n      hublot.classList.add('closeLid');\n      lid.classList.add('pullHandle');\n      handle.classList.add('pullHandle');\n\n    }\n    open = !open;\n    \n  }\n}","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.scrollama = factory());\n}(this, (function () { 'use strict';\n\n  // DOM helper functions\n\n  // public\n  function selectAll(selector, parent = document) {\n    if (typeof selector === 'string') {\n      return Array.from(parent.querySelectorAll(selector));\n    } else if (selector instanceof Element) {\n      return [selector];\n    } else if (selector instanceof NodeList) {\n      return Array.from(selector);\n    } else if (selector instanceof Array) {\n      return selector;\n    }\n    return [];\n  }\n\n  // SETUP\n  function create(className) {\n  \tconst el = document.createElement(\"div\");\n  \tel.className = `scrollama__debug-step ${className}`;\n  \tel.style.position = \"fixed\";\n  \tel.style.left = \"0\";\n  \tel.style.width = \"100%\";\n  \tel.style.zIndex = \"9999\";\n  \tel.style.borderTop = \"2px solid black\";\n  \tel.style.borderBottom = \"2px solid black\";\n\n  \tconst p = document.createElement(\"p\");\n  \tp.style.position = \"absolute\";\n  \tp.style.left = \"0\";\n  \tp.style.height = \"1px\";\n  \tp.style.width = \"100%\";\n  \tp.style.borderTop = \"1px dashed black\";\n\n  \tel.appendChild(p);\n  \tdocument.body.appendChild(el);\n  \treturn el;\n  }\n\n  // UPDATE\n  function update({ id, step, marginTop }) {\n  \tconst { index, height } = step;\n  \tconst className = `scrollama__debug-step--${id}-${index}`;\n  \tlet el = document.querySelector(`.${className}`);\n  \tif (!el) el = create(className);\n\n  \tel.style.top = `${marginTop * -1}px`;\n  \tel.style.height = `${height}px`;\n  \tel.querySelector(\"p\").style.top = `${height / 2}px`;\n  }\n\n  function generateId() {\n      const alphabet = \"abcdefghijklmnopqrstuvwxyz\";\n      const date = Date.now();\n      const result = [];\n      for (let i = 0; i < 6; i += 1) {\n        const char = alphabet[Math.floor(Math.random() * alphabet.length)];\n        result.push(char);\n      }\n      return `${result.join(\"\")}${date}`;\n    }\n\n  function err$1(msg) {\n  \tconsole.error(`scrollama error: ${msg}`);\n  }\n\n  function getIndex(node) {\n  \treturn +node.getAttribute(\"data-scrollama-index\");\n  }\n\n  function createProgressThreshold(height, threshold) {\n      const count = Math.ceil(height / threshold);\n      const t = [];\n      const ratio = 1 / count;\n      for (let i = 0; i < count + 1; i += 1) {\n        t.push(i * ratio);\n      }\n      return t;\n    }\n\n  function parseOffset(x) {\n  \tif (typeof x === \"string\" && x.indexOf(\"px\") > 0) {\n  \t\tconst v = +x.replace(\"px\", \"\");\n  \t\tif (!isNaN(v)) return { format: \"pixels\", value: v };\n  \t\telse {\n  \t\t\terr(\"offset value must be in 'px' format. Fallback to 0.5.\");\n  \t\t\treturn { format: \"percent\", value: 0.5 };\n  \t\t}\n  \t} else if (typeof x === \"number\" || !isNaN(+x)) {\n  \t\tif (x > 1) err(\"offset value is greater than 1. Fallback to 1.\");\n  \t\tif (x < 0) err(\"offset value is lower than 0. Fallback to 0.\");\n  \t\treturn { format: \"percent\", value: Math.min(Math.max(0, x), 1) };\n  \t}\n  \treturn null;\n  }\n\n  function indexSteps(steps) {\n  \tsteps.forEach((step) =>\n  \t\tstep.node.setAttribute(\"data-scrollama-index\", step.index)\n  \t);\n  }\n\n  function getOffsetTop(node) {\n    const { top } = node.getBoundingClientRect();\n    const scrollTop = window.pageYOffset;\n    const clientTop = document.body.clientTop || 0;\n    return top + scrollTop - clientTop;\n  }\n\n  let currentScrollY;\n  let comparisonScrollY;\n  let direction;\n\n  function onScroll(container) {\n  \tconst scrollTop = container ? container.scrollTop : window.pageYOffset;\n\n  \tif (currentScrollY === scrollTop) return;\n  \tcurrentScrollY = scrollTop;\n  \tif (currentScrollY > comparisonScrollY) direction = \"down\";\n  \telse if (currentScrollY < comparisonScrollY) direction = \"up\";\n  \tcomparisonScrollY = currentScrollY;\n  }\n\n  function setupScroll(container) {\n  \tcurrentScrollY = 0;\n  \tcomparisonScrollY = 0;\n  \tdocument.addEventListener(\"scroll\", () => onScroll(container));\n  }\n\n  function scrollama() {\n  \tlet cb = {};\n\n  \tlet id = generateId();\n  \tlet steps = [];\n  \tlet globalOffset;\n  \tlet containerElement;\n  \tlet rootElement;\n\n  \tlet progressThreshold = 0;\n\n  \tlet isEnabled = false;\n  \tlet isProgress = false;\n  \tlet isDebug = false;\n  \tlet isTriggerOnce = false;\n\n  \tlet exclude = [];\n\n  \t/* HELPERS */\n  \tfunction reset() {\n  \t\tcb = {\n  \t\t\tstepEnter: () => { },\n  \t\t\tstepExit: () => { },\n  \t\t\tstepProgress: () => { },\n  \t\t};\n  \t\texclude = [];\n  \t}\n\n  \tfunction handleEnable(shouldEnable) {\n  \t\tif (shouldEnable && !isEnabled) updateObservers();\n  \t\tif (!shouldEnable && isEnabled) disconnectObservers();\n  \t\tisEnabled = shouldEnable;\n  \t}\n\n  \t/* NOTIFY CALLBACKS */\n  \tfunction notifyProgress(element, progress) {\n  \t\tconst index = getIndex(element);\n  \t\tconst step = steps[index];\n  \t\tif (progress !== undefined) step.progress = progress;\n  \t\tconst response = { element, index, progress, direction };\n  \t\tif (step.state === \"enter\") cb.stepProgress(response);\n  \t}\n\n  \tfunction notifyStepEnter(element, check = true) {\n  \t\tconst index = getIndex(element);\n  \t\tconst step = steps[index];\n  \t\tconst response = { element, index, direction };\n\n  \t\tstep.direction = direction;\n  \t\tstep.state = \"enter\";\n\n  \t\t// if (isPreserveOrder && check && direction !== \"up\")\n  \t\t//   notifyOthers(index, \"above\");\n  \t\t// if (isPreserveOrder && check && direction === \"up\")\n  \t\t//   notifyOthers(index, \"below\");\n\n  \t\tif (!exclude[index]) cb.stepEnter(response);\n  \t\tif (isTriggerOnce) exclude[index] = true;\n  \t}\n\n  \tfunction notifyStepExit(element, check = true) {\n  \t\tconst index = getIndex(element);\n  \t\tconst step = steps[index];\n\n  \t\tif (!step.state) return false;\n\n  \t\tconst response = { element, index, direction };\n\n  \t\tif (isProgress) {\n  \t\t\tif (direction === \"down\" && step.progress < 1) notifyProgress(element, 1);\n  \t\t\telse if (direction === \"up\" && step.progress > 0)\n  \t\t\t\tnotifyProgress(element, 0);\n  \t\t}\n\n  \t\tstep.direction = direction;\n  \t\tstep.state = \"exit\";\n\n  \t\tcb.stepExit(response);\n  \t}\n\n  \t/* OBSERVERS - HANDLING */\n  \tfunction resizeStep([entry]) {\n  \t\tconst index = getIndex(entry.target);\n  \t\tconst step = steps[index];\n  \t\tconst h = entry.target.offsetHeight;\n  \t\tif (h !== step.height) {\n  \t\t\tstep.height = h;\n  \t\t\tdisconnectObserver(step);\n  \t\t\tupdateStepObserver(step);\n  \t\t\tupdateResizeObserver(step);\n  \t\t}\n  \t}\n\n  \tfunction intersectStep([entry]) {\n  \t\tonScroll(containerElement);\n\n  \t\tconst { isIntersecting, target } = entry;\n  \t\tif (isIntersecting) notifyStepEnter(target);\n  \t\telse notifyStepExit(target);\n  \t}\n\n  \tfunction intersectProgress([entry]) {\n  \t\tconst index = getIndex(entry.target);\n  \t\tconst step = steps[index];\n  \t\tconst { isIntersecting, intersectionRatio, target } = entry;\n  \t\tif (isIntersecting && step.state === \"enter\")\n  \t\t\tnotifyProgress(target, intersectionRatio);\n  \t}\n\n  \t/*  OBSERVERS - CREATION */\n  \tfunction disconnectObserver({ observers }) {\n  \t\tObject.keys(observers).map((name) => {\n  \t\t\tobservers[name].disconnect();\n  \t\t});\n  \t}\n\n  \tfunction disconnectObservers() {\n  \t\tsteps.forEach(disconnectObserver);\n  \t}\n\n  \tfunction updateResizeObserver(step) {\n  \t\tconst observer = new ResizeObserver(resizeStep);\n  \t\tobserver.observe(step.node);\n  \t\tstep.observers.resize = observer;\n  \t}\n\n  \tfunction updateResizeObservers() {\n  \t\tsteps.forEach(updateResizeObserver);\n  \t}\n\n  \tfunction updateStepObserver(step) {\n  \t\tconst h = window.innerHeight;\n  \t\tconst off = step.offset || globalOffset;\n  \t\tconst factor = off.format === \"pixels\" ? 1 : h;\n  \t\tconst offset = off.value * factor;\n  \t\tconst marginTop = step.height / 2 - offset;\n  \t\tconst marginBottom = step.height / 2 - (h - offset);\n  \t\tconst rootMargin = `${marginTop}px 0px ${marginBottom}px 0px`;\n  \t\tconst root = rootElement;\n\n  \t\tconst threshold = 0.5;\n  \t\tconst options = { rootMargin, threshold, root };\n  \t\tconst observer = new IntersectionObserver(intersectStep, options);\n\n  \t\tobserver.observe(step.node);\n  \t\tstep.observers.step = observer;\n\n  \t\tif (isDebug) update({ id, step, marginTop, marginBottom });\n  \t}\n\n  \tfunction updateStepObservers() {\n  \t\tsteps.forEach(updateStepObserver);\n  \t}\n\n  \tfunction updateProgressObserver(step) {\n  \t\tconst h = window.innerHeight;\n  \t\tconst off = step.offset || globalOffset;\n  \t\tconst factor = off.format === \"pixels\" ? 1 : h;\n  \t\tconst offset = off.value * factor;\n  \t\tconst marginTop = -offset + step.height;\n  \t\tconst marginBottom = offset - h;\n  \t\tconst rootMargin = `${marginTop}px 0px ${marginBottom}px 0px`;\n\n  \t\tconst threshold = createProgressThreshold(step.height, progressThreshold);\n  \t\tconst options = { rootMargin, threshold };\n  \t\tconst observer = new IntersectionObserver(intersectProgress, options);\n\n  \t\tobserver.observe(step.node);\n  \t\tstep.observers.progress = observer;\n  \t}\n\n  \tfunction updateProgressObservers() {\n  \t\tsteps.forEach(updateProgressObserver);\n  \t}\n\n  \tfunction updateObservers() {\n  \t\tdisconnectObservers();\n  \t\tupdateResizeObservers();\n  \t\tupdateStepObservers();\n  \t\tif (isProgress) updateProgressObservers();\n  \t}\n\n  \t/* SETUP */\n  \tconst S = {};\n\n  \tS.setup = ({\n  \t\tstep,\n  \t\tparent,\n  \t\toffset = 0.5,\n  \t\tthreshold = 4,\n  \t\tprogress = false,\n  \t\tonce = false,\n  \t\tdebug = false,\n  \t\tcontainer = undefined,\n  \t\troot = null\n  \t}) => {\n\n  \t\tsetupScroll(container);\n\n  \t\tsteps = selectAll(step, parent).map((node, index) => ({\n  \t\t\tindex,\n  \t\t\tdirection: undefined,\n  \t\t\theight: node.offsetHeight,\n  \t\t\tnode,\n  \t\t\tobservers: {},\n  \t\t\toffset: parseOffset(node.dataset.offset),\n  \t\t\ttop: getOffsetTop(node),\n  \t\t\tprogress: 0,\n  \t\t\tstate: undefined,\n  \t\t}));\n\n  \t\tif (!steps.length) {\n  \t\t\terr$1(\"no step elements\");\n  \t\t\treturn S;\n  \t\t}\n\n  \t\tisProgress = progress;\n  \t\tisTriggerOnce = once;\n  \t\tisDebug = debug;\n  \t\tprogressThreshold = Math.max(1, +threshold);\n  \t\tglobalOffset = parseOffset(offset);\n  \t\tcontainerElement = container;\n  \t\trootElement = root;\n\n  \t\treset();\n  \t\tindexSteps(steps);\n  \t\thandleEnable(true);\n  \t\treturn S;\n  \t};\n\n  \tS.enable = () => {\n  \t\thandleEnable(true);\n  \t\treturn S;\n  \t};\n\n  \tS.disable = () => {\n  \t\thandleEnable(false);\n  \t\treturn S;\n  \t};\n\n  \tS.destroy = () => {\n  \t\thandleEnable(false);\n  \t\treset();\n  \t\treturn S;\n  \t};\n\n  \tS.resize = () => {\n  \t\tupdateObservers();\n  \t\treturn S;\n  \t};\n\n  \tS.offset = (x) => {\n  \t\tif (x === null || x === undefined) return globalOffset.value;\n  \t\tglobalOffset = parseOffset(x);\n  \t\tupdateObservers();\n  \t\treturn S;\n  \t};\n\n  \tS.onStepEnter = (f) => {\n  \t\tif (typeof f === \"function\") cb.stepEnter = f;\n  \t\telse err$1(\"onStepEnter requires a function\");\n  \t\treturn S;\n  \t};\n\n  \tS.onStepExit = (f) => {\n  \t\tif (typeof f === \"function\") cb.stepExit = f;\n  \t\telse err$1(\"onStepExit requires a function\");\n  \t\treturn S;\n  \t};\n\n  \tS.onStepProgress = (f) => {\n  \t\tif (typeof f === \"function\") cb.stepProgress = f;\n  \t\telse err$1(\"onStepProgress requires a function\");\n  \t\treturn S;\n  \t};\n  \treturn S;\n  }\n\n  return scrollama;\n\n})));\n","import Tooltip from '../tooltip';\nimport * as preprocess from '../preprocess.js';\n\n/**\n * Création d'un objet Network\n * @param {*} svg balise du DOM contenant le graphique généré\n * @param {integer} ratio rapport long/larg de la taille disponible\n */\nexport default class Network {\n\n/**\n * Création d'un objet Network\n * @param {*} svg balise du DOM contenant le graphique généré\n * @param {integer} ratio rapport long/larg de la taille disponible\n */\n  constructor(svg, ratio = 1) {\n    this.tooltip = new Tooltip()\n    this.tooltipLegend = new Tooltip(\"#viz2\")\n    this.ratio = ratio\n    this.svg = svg;\n    this.airportCode = {};\n    this.levelGeo = { 1: \"QC\", 2: \"CA\", 3: \"WORLD\", 4: null, \"QC\": 1, \"CA\": 2, \"WORLD\": 3, null: 4 };\n    this.ccolor = {\n      \"Africa\": 'rgba(0, 0, 255,',\n      \"America\": 'rgba(151, 18, 18,',\n      \"Europe\": 'rgba(0, 255, 0,',\n      \"Asia\": 'rgba(0, 255, 255,',\n      \"Oceania\": 'rgba(255, 0, 255,'\n    }\n    this.currentGeo = \"QC\";\n    this.limits = [];\n    this.minMaxXGlobal = [1000000, 0];\n    this.minMaxYGlobal = [1000000, 0];\n    this.isFlightShow = false;\n\n    this.createLegend();\n  }\n\n  /**\n   * Affiche les différents aéroports d'un niveau \n   * @param {*} val valeur subissant la transformation\n   */\n  scaleSize(val) {\n    return 2 * (parseFloat(val) / 10E4 + Math.log(val) / 5);\n  }\n\n  /**\n   * Met à jour le status géographique courant \n   * @param {*} val valeur d'incrément\n   */\n  updateCurrentState(val) {\n    this.currentGeo = this.levelGeo[this.levelGeo[this.currentGeo] + val];\n  }\n\n\n  /**\n   * Affiche les différents aéroports d'un niveau \n   * donné selon l'état interne du système.\n   */\n  createLegend() {\n    var self = this\n\n    self.tooltipLegend.createLegendNetwork()\n    var infoButtion_siCliked = false\n    d3.select(\"#infoNetworkButton\")\n      .style(\"cursor\", \"help\")\n      .on(\"click\", function () {\n        infoButtion_siCliked = !infoButtion_siCliked;\n        if (infoButtion_siCliked) {\n          return self.tooltipLegend.showLegendNetwork();\n        } else {\n          return self.tooltipLegend.hiddenLegendNetwork();\n        }\n      }).on(\"mouseover\", function () {\n        d3.select(this).style(\"color\", \"blue\")\n      }).on(\"mouseleave\", function () {\n        d3.select(this).style(\"color\", \"black\")\n      })\n  }\n\n  createLegend() {\n    var self = this\n\n    self.tooltipLegend.createLegendNetwork()\n    var infoButtion_siCliked = false\n    d3.select(\"#infoNetworkButton\")\n      .style(\"cursor\", \"help\")\n      .on(\"click\", function () {\n        infoButtion_siCliked = !infoButtion_siCliked;\n        if (infoButtion_siCliked) {\n          return self.tooltipLegend.showLegendNetwork();\n        } else {\n          return self.tooltipLegend.hiddenLegendNetwork();\n        }\n      }).on(\"mouseover\", function () {\n        d3.select(this).style(\"color\", \"blue\")\n      }).on(\"mouseleave\", function () {\n        d3.select(this).style(\"color\", \"black\")\n      })\n  }\n\n\n  /**\n   * Affiche les différents aéroports d'un niveau \n   * donné selon l'état interne du système.\n   */\n  displayAirports() {\n\n    var readAirports = function (localairports) {\n\n      switch (this.currentGeo) {\n        case \"QC\":\n          this.tooltipLegend.addAirportLegendNetwork(this.currentGeo, \"québécois\", 'rgba(255, 0, 0, 0.6)');\n          break;\n        case \"CA\":\n          this.tooltipLegend.addAirportLegendNetwork(this.currentGeo, \"américain non québécois\", this.ccolor['America'] + '0.6)');\n          break;\n        case \"WORLD\":\n          for (let cont of [[\"Africa\", \"africain\"], [\"Europe\", \"européen\"], [\"Asia\", \"asiatique\"], [\"Oceania\", \"océanien\"]]) {\n            this.tooltipLegend.addAirportLegendNetwork(this.currentGeo, cont[1], this.ccolor[cont[0]] + '0.6)');\n          }\n          break;\n      }\n\n      var nb = localairports.length\n      var minMaxX = d3.extent(localairports, d => parseFloat(d.lat))\n      var minMaxY = d3.extent(localairports, d => parseFloat(d.lon) / this.ratio)\n      // Mise à jour des données selon les dimensions de l'écran disponible\n      localairports.forEach(item => this.airportCode[item.airport] = [parseFloat(item.lat), parseFloat(item.lon) / this.ratio])\n\n      minMaxX = [Math.min(minMaxX[0] - 10, this.minMaxXGlobal[0]), Math.max(minMaxX[1] + 10, this.minMaxXGlobal[1])]\n      minMaxY = [Math.min(minMaxY[0] - 10, this.minMaxYGlobal[0]), Math.max(minMaxY[1] + 10, this.minMaxYGlobal[1])]\n\n      if (this.limits[this.levelGeo[this.currentGeo]] === undefined) {\n        this.limits[this.levelGeo[this.currentGeo]] = `${minMaxX[0]},${minMaxY[0]},${minMaxX[1] - minMaxX[0]},${minMaxY[1] - minMaxY[0]}`\n      }\n\n      this.minMaxXGlobal, this.minMaxYGlobal = minMaxX, minMaxY\n\n      var self = this\n\n      this.svg.transition()\n        .ease(d3.easePolyInOut)\n        .duration(800)\n        .attr(\"viewBox\", this.limits[this.levelGeo[this.currentGeo]])\n        .attr(\"transform-box\", \"content-box\")\n\n      // Gestion de l'affichage\n      var circles = this.svg.selectAll('airports')\n        .data(localairports)\n        .join('circle')\n\n      if (this.currentGeo !== \"WORLD\") {\n        circles.on(\"mouseover\", function (m, data) {\n          d3.select(this)\n            .attr(\"r\", d => 1.5 * self.scaleSize(d.freq))\n            .attr('stroke-width', '.4')\n          return self.tooltip.showTooltipAirport(m, [data.airport, data.country, data.city, data.freq])\n        })\n          .on(\"mouseleave\", function (e) {\n            d3.select(this)\n              .attr(\"r\", d => self.scaleSize(d.freq))\n              .attr('stroke-width', '.1')\n            return self.tooltip.hideTooltip()\n          })\n      }\n\n      // Affichage des cercles visibles\n      circles.attr('stroke', 'black')\n        .attr('stroke-width', '.1')\n        .attr('class', d => this.currentGeo + \" \" + d.continent + \" \" + d.airport)\n        .attr(\"transform\", d => `translate(${this.airportCode[d.airport]})`)\n        .attr(\"r\", 0)\n        .transition()\n        .ease(d3.easeCubicOut)\n        .delay(function (d, i) { return 100 * i / nb; })\n        .duration(800)\n        .attr(\"r\", d => this.scaleSize(d.freq))\n        .style('fill', d => (this.currentGeo == \"QC\") ? 'rgba(255, 0, 0, 0.6)' : (this.ccolor[d.continent] + ' 0.6)'))\n\n      if (this.currentGeo === \"WORLD\") {\n\n        var circlesTooltips = this.svg.selectAll('airports')\n          .data(localairports)\n          .join('circle')\n\n        // Création des cercles d'interaction, plus larges\n        circlesTooltips.attr(\"r\", d => Math.max(8, self.scaleSize(d.freq)))\n          .attr(\"transform\", d => `translate(${this.airportCode[d.airport]})`)\n          .attr(\"opacity\", 0)\n          .attr(\"class\", d => this.currentGeo + \" \" + d.continent + \" \" + d.airport + \" tooltipsCircle\")\n          .on(\"mouseover\", function (m, data) {\n            d3.select(\".\" + data.airport)\n              .attr(\"r\", 1.5 * self.scaleSize(data.freq))\n              .attr('stroke-width', '.4')\n            return self.tooltip.showTooltipAirport(m, [data.airport, data.country, data.city, data.freq])\n          })\n          .on(\"mouseleave\", function (m, data) {\n            d3.select(\".\" + data.airport).attr(\"r\", d => Math.log(d.freq + 1) / 4)\n              .attr('stroke-width', '.1')\n            return self.tooltip.hideTooltip()\n          })\n      }\n\n      this.updateCurrentState(1)\n\n    }\n\n    d3.csv(`./${this.currentGeo}/airports${this.currentGeo}.csv`)\n      .then(readAirports.bind(this))\n\n  }\n\n  /**\n   * Affiche les différents vols d'un niveau \n   * donné selon l'état interne du système.\n   */\n  displayFlights() {\n\n    var readFlights = function (localflights) {\n\n      if (this.currentGeo == \"QC\") {\n        this.isFlightShow = true;\n        this.tooltipLegend.addFlightLegendNetwork(\"Vols des principales compagnies\", 'rgba(0, 0, 0, 0.2)');\n        this.tooltipLegend.addFlightLegendNetwork(\"Autres vols\", 'rgba(187, 40, 255, 0.2)');\n      }\n\n      this.svg.selectAll('flights')\n        .data(localflights)\n        .join('line')\n        .attr('class', this.currentGeo)\n        .attr('x1', d => this.airportCode[d.airportIn][0])\n        .attr('y1', d => this.airportCode[d.airportIn][1])\n        .attr('x2', d => this.airportCode[d.airportIn][0])\n        .attr('y2', d => this.airportCode[d.airportIn][1])\n        .style('stroke-width', d => 2 * this.scaleSize(d.number))\n        .transition()\n        .ease(d3.easeCubicInOut)\n        .duration(800)\n        .attr('x2', d => this.airportCode[d.airportOut][0])\n        .attr('y2', d => this.airportCode[d.airportOut][1])\n        .style('stroke', d => (d.company !== \"OTHERS\") ? 'rgba(187, 40, 255, 0.2)' : 'rgba(0, 0, 0, 0.04)')\n\n      this.updateCurrentState(1)\n      this.svg.selectAll('circle').raise()\n    }\n\n    this.updateCurrentState(-1)\n    d3.csv(`./${this.currentGeo}/flights${this.currentGeo}.csv`)\n      .then(preprocess.groupByMainCompanies)\n      .then(readFlights.bind(this))\n  }\n\n  /**\n   * Supprime les différents aéroports d'un niveau \n   * donnée selon l'état interne du système.\n   * @param {boolean} firstTransition permière transition\n   */\n  removeAirports(firstTransition = false) {\n    this.updateCurrentState(-1)\n\n    if (!firstTransition) {\n      this.tooltipLegend.delAirportLegendNetwork(this.currentGeo)\n\n      this.svg.transition()\n        .duration(1000)\n        .attr(\"viewBox\", this.limits[this.levelGeo[this.currentGeo] - 1])\n\n      this.svg.selectAll('circle.' + this.currentGeo)\n        .transition()\n        .duration(1000)\n        .attr(\"r\", 0)\n        .remove()\n\n    } else {\n      // supprime l'ensemble des données affichées\n      // Efface l'ensemble des données\n      this.currentGeo = \"QC\";\n\n      [\"WORLD\", \"CA\", \"QC\"].forEach(lvl => {\n        this.tooltipLegend.delAirportLegendNetwork(lvl)\n\n        this.svg.selectAll('line.' + lvl)\n          .transition()\n          .duration(1000)\n          .style('stroke', 'rgba(0, 0, 0, 0.0)')\n          .remove()\n\n        this.svg.selectAll('circle.' + lvl)\n          .transition()\n          .duration(1000)\n          .attr(\"r\", 0)\n          .remove()\n      });\n    }\n  }\n\n  /**\n   * Supprime les différents vols d'un niveau \n   * donnée selon l'état interne du système.\n   */\n  removeFlights() {\n\n    if (this.levelGeo[this.levelGeo[this.currentGeo] - 1] === \"QC\") {\n      this.isFlightShow = true;\n      this.tooltipLegend.delFlightLegendNetwork();\n    }\n\n    this.svg.selectAll('line.' + this.levelGeo[this.levelGeo[this.currentGeo] - 1])\n      .transition()\n      .duration(1000)\n      .style('stroke', 'rgba(0, 0, 0, 0.0)')\n      .remove()\n  }\n}","import scrollama from \"scrollama\";\nimport Network from \"./scrolly/network.js\";\nimport Tooltip from './tooltip';\n\nvar scrolly = d3.select(\"#scrolly\");\nvar figure = scrolly.select(\"figure\");\nvar article = scrolly.select(\"article\");\nvar step = article.selectAll(\".step\");\n\nvar figureHeight = 4 * window.innerHeight / 5;\n\n// Initialise le scrolly-telling\nvar scroller = scrollama();\n\nconst svg = d3.select('#viz2')\n    .append('svg')\n\nconst figWidth = d3.select(\"figure\")\n    .node()\n    .getBoundingClientRect()\n    .width\n\nconst network = new Network(svg, figWidth / figureHeight);\n\n/**\n * Gère l'affichage des différents phases de la construction du réseau\n * @param {*} response phase du scrolling\n */\nfunction handleStepEnter(response) {\n    if (response.direction === 'down') {\n        if (response.index % 2 === 0 && response.index !== 6) {\n            network.displayAirports()\n        } else if (response.index % 2 === 1) {\n            network.displayFlights()\n        }\n    } else {\n        if ((response.index % 2 === 1) && response.index !== 5) {\n            network.removeAirports()\n        } else if ((response.index % 2 === 0) && response.index !== 6) {\n            network.removeFlights()\n        }\n    }\n}\n\n/**\n* Redimensionne la visualisation à la taille de l'écran\n*/\nfunction handleResize() {\n    const stepH = Math.floor(window.innerHeight * 0.75);\n    step.style(\"height\", stepH + \"px\");\n    const figureMarginTop = (window.innerHeight - figureHeight) / 2;\n\n    figure.style(\"height\", figureHeight + \"px\")\n        .style(\"top\", figureMarginTop + \"px\");\n\n    scroller.resize();\n}\n\n/**\n * Efface l'ensemble des données lors de la sortie \n * du scrolly-telling par le haut\n * @param {*} response phase du scrolling\n */\nfunction handleStepExit(response) {\n    if (response.direction === 'up' && response.index === 0) {\n        network.removeAirports(true);\n    }\n}\n\n\n/**\n * Initialise la création du réseau\n */\nexport function initNetwork() {\n\n    handleResize();\n    scroller\n        .setup({\n            step: \"#scrolly article .step\",\n            offset: 0.33,\n            debug: false\n        })\n        .onStepExit(handleStepExit)\n        .onStepEnter(handleStepEnter);\n}","import * as waffles from './scripts/viz4.js'\nimport * as alluvial from './scripts/alluvial.js'\nimport * as buckets from './scripts/viz1.js'\nimport * as preprocess from './scripts/preprocess.js'\nimport * as network from './scripts/scrolly.js'\n\nwindow.onbeforeunload = function () {\n    window.scrollTo(0, 0);\n  }\n\nwindow.onload = () => {\n\n    Promise.all([\n        d3.csv('./WORLD/flightsWORLD.csv'),\n        d3.csv('./CA/flightsCA.csv'),\n        d3.csv('./QC/flightsQC.csv'),\n        d3.csv('./alluvial_data.csv')\n    ]).then(function (files) {\n        preprocess.setData(files[0].concat(files[1], files[2]));\n        preprocess.setAlluvialData(files[3]);\n        preprocess.setTopCompaniesCount(5);\n        buckets.displayBucketGraph();\n        buckets.setUpSlider();\n    })\n\n    network.initNetwork()\n    // alluvial.initAlluvial()\n    waffles.initWaffle()\n};\n\n\n\n\n"]}